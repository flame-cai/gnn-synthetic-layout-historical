2026-01-04 13:28:50,440 - INFO - Overriding device to: cuda:0 from command line argument --gpu_id.
2026-01-04 13:28:50,440 - INFO - ===== Starting Fold 0 for Model: SplineCNN =====
2026-01-04 13:28:51,778 - INFO - Using learning rate warmup for 5 epochs.
2026-01-04 13:28:51,778 - INFO - Using Focal Loss
2026-01-04 13:28:51,779 - INFO - --- PRE-TRAINING LOADER TEST ---
2026-01-04 13:28:51,785 - INFO - >>> SUCCESS: next(iter(val_loader)) worked perfectly before training. <<<
2026-01-04 13:28:51,785 - INFO - --- Starting Training Loop ---
2026-01-04 13:28:51,785 - INFO - --- Epoch 1/3 ---
2026-01-04 13:30:39,740 - INFO - Textline Metrics | TP: 1023, FP: 522, FN: 288 | F1: 0.7164
2026-01-04 13:30:39,740 - INFO - Epoch 1: Train Loss: 0.0296, Val Textline F1: 0.7164, LR: 0.000200
2026-01-04 13:30:39,740 - INFO - The precision is: 0.7163865546218489
2026-01-04 13:30:39,794 - INFO - Saved checkpoint to training_runs/gnn_experiment_1/SplineCNN-fold_0-20260104-132850/best_model.pt
2026-01-04 13:30:39,794 - INFO - --- Epoch 2/3 ---
2026-01-04 13:32:40,489 - INFO - Textline Metrics | TP: 1083, FP: 217, FN: 228 | F1: 0.8296
2026-01-04 13:32:40,490 - INFO - Epoch 2: Train Loss: 0.0065, Val Textline F1: 0.8296, LR: 0.000400
2026-01-04 13:32:40,490 - INFO - The precision is: 0.8295672156261968
2026-01-04 13:32:40,490 - INFO - Validation metric improved (0.716387 --> 0.829567). Saving model ...
2026-01-04 13:32:40,663 - INFO - Saved checkpoint to training_runs/gnn_experiment_1/SplineCNN-fold_0-20260104-132850/best_model.pt
2026-01-04 13:32:40,663 - INFO - --- Epoch 3/3 ---
2026-01-04 13:34:43,728 - INFO - Textline Metrics | TP: 1122, FP: 192, FN: 189 | F1: 0.8549
2026-01-04 13:34:43,729 - INFO - Epoch 3: Train Loss: 0.0046, Val Textline F1: 0.8549, LR: 0.000600
2026-01-04 13:34:43,729 - INFO - The precision is: 0.8548571428571429
2026-01-04 13:34:43,729 - INFO - Validation metric improved (0.829567 --> 0.854857). Saving model ...
2026-01-04 13:34:43,894 - INFO - Saved checkpoint to training_runs/gnn_experiment_1/SplineCNN-fold_0-20260104-132850/best_model.pt
2026-01-04 13:34:43,895 - INFO - --- Final Evaluation on Test Set ---
2026-01-04 13:34:43,961 - WARNING - Batch size is 3 during evaluation. Textline F1-Score calculation is skipped for this batch. Please use batch_size=1 for accurate validation metrics.
2026-01-04 13:34:43,964 - INFO - Textline Metrics | TP: 0, FP: 0, FN: 0 | F1: 0.0000
2026-01-04 13:34:43,965 - INFO - Test Metrics: {'test_loss': 0.0017317335586994886, 'test_accuracy': 0.9978784725002001, 'test_f1_score_macro': 0.9957703150675166, 'test_textline_f1_score': 0.0, 'test_textline_precision': 0.0, 'test_textline_recall': 0.0}
2026-01-04 13:34:55,051 - INFO - 

===== Aggregated Cross-Validation Results =====
