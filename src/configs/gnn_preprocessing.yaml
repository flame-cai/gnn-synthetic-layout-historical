# ===================================================================
#             Dataset Creation Configuration
# ===================================================================

min_nodes_per_page: 10 # Skip pages with fewer nodes than this

# --- MODIFIED: Data splitting configuration for a fixed split ---
splitting:
  random_seed: 49 # Seed for shuffling the val/test data before splitting
  val_ratio: 0.99 # 95% of val_test_data_dir goes to validation, 5% to test

# ===================================================================
#                Input Graph Construction
# ===================================================================
input_graph:
  # --- Heuristic Graph (Optional) ---
  use_heuristic_graph: True
  heuristic_params:
    k: 10 # HEURISTIC_GRAPH_K
    cosine_sim_threshold: -0.8 # OPPOSITE_NEIGHBOR_COS_SIM_THRESHOLD

  # --- Additional Connectivity ---
  # Strategy to add more edges to ensure GT is a subset.
  # Options: "knn", "none" (future: "expander")
  connectivity:
    # strategies: ["knn"] # Example: using both strategies "knn", 
    strategies: ["angular_knn"] #angular_knn

    # Parameters for the knn strategy
    knn_params:
      k: 12 # K for KNN # we can only predict if this is a "true" super set. Make this big!

    # Parameters for the second_shortest_heuristic strategy
    second_shortest_params:
          k: 10 # Number of neighbors to consider for finding pairs
          cosine_sim_threshold: -0.8 # Collinearity threshold
          min_angle_degrees: 45 # The minimum angle between the 1st and 2nd best pairs' edges

    angular_knn_params:
      k: 50 # K for angular KNN
      sector_angle_degrees: 20 # Minimum angle between edges to consider them connected


  # --- Graph Structure ---
  # Options: "bidirectional", "unidirectional"
  directionality: "bidirectional"

# ===================================================================
#                  Feature Engineering
# ===================================================================
features:
  # --- Node Features ---
  use_node_coordinates: True
  use_node_font_size: False
  use_heuristic_degree: True
  heuristic_degree_encoding: "one_hot" # Options: "linear_map", "one_hot"
  heuristic_degree_encoding_params:
    linear_map_factor: 0.1
    one_hot_max_degree: 10 # Cap for one-hot encoding dimension

  # --- Edge Features ---
  use_relative_distance: True # rel_x, rel_y
  use_euclidean_distance: True
  use_aspect_ratio_rel: True
  use_overlap: True
  overlap_encoding: "one_hot" # Options: "linear_map", "one_hot"
  overlap_encoding_params:
    linear_map_factor: 0.1
    one_hot_max_overlap: 10

  # --- Graph-level Features ---
  use_page_aspect_ratio: True  # bug: not being used

# ===================================================================
#              Ground Truth Graph Construction
# ===================================================================
ground_truth:
  # Algorithm to connect nodes within a textline
  # Options: "mst", "greedy_path"
  algorithm: "mst"

# ===================================================================
#               Alternate (Sklearn) Dataset Format
# ===================================================================
sklearn_format:
  enabled: False
  features:
    # Select which features to include in the CSV
    - "source_node_features" # includes x, y, font_size, heuristic_degree
    - "target_node_features"
    - "edge_features" # includes all enabled edge features
    - "page_features" # includes page_aspect_ratio
  # Advanced: Add aggregated features from N-hop neighbors
  # This is computationally expensive.
  use_n_hop_features: False
  n_hop_config:
    hops: 1 # Number of hops
    aggregations: ["mean", "std"] # Aggregations to apply